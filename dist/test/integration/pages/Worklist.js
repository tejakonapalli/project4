sap.ui.define(["sap/ui/test/Opa5","sap/ui/test/actions/Press","sap/ui/test/actions/EnterText","sap/ui/test/matchers/AggregationLengthEquals","sap/ui/test/matchers/AggregationFilled","sap/ui/test/matchers/PropertyStrictEquals","./Common"],function(e,t,i,n,r,s,a){"use strict";var o="Worklist",h="table",c="searchField",u="*#-Q@@||";function l(e){var t=e[0],i=e[1],n=t.getItems();if(n.length===0){return false}return n.every(function(e){return e.getCells()[0].getTitle().indexOf(i.getValue())!==-1})}function m(e){var t=e.position;return{id:h,viewName:o,matchers:function(e){return e.getItems()[t]},actions:e.actions,success:e.success,errorMessage:"Table in view '"+o+"' does not contain an Item at position '"+t+"'"}}e.createPageObjects({onTheWorklistPage:{baseClass:a,actions:Object.assign({iPressATableItemAtPosition:function(e){return this.waitFor(m({position:e,actions:new t}))},iRememberTheItemAtPosition:function(e){return this.waitFor(m({position:e,success:function(e){var t=e.getBindingContext();this.getContext().currentItem={bindingPath:t.getPath(),id:t.getProperty("Posnr"),name:t.getProperty("Matnr")}}}))},iSearchForTheFirstObject:function(){var e;return this.waitFor({id:h,viewName:o,matchers:new r({name:"items"}),success:function(t){e=t.getItems()[0].getCells()[0].getTitle();this.iSearchForValue(e);this.waitFor({id:[h,c],viewName:o,check:l,errorMessage:"Did not find any table entries or too many while trying to search for the first object."})},errorMessage:"Did not find table entries while trying to search for the first object."})},iSearchForValueWithActions:function(e){return this.waitFor({id:c,viewName:o,actions:e,errorMessage:"Failed to find search field in Worklist view.'"})},iSearchForValue:function(e){return this.iSearchForValueWithActions([new i({text:e}),new t])},iTypeSomethingInTheSearchThatCannotBeFoundAndTriggerRefresh:function(){var e=function(e){e.setValue(u);e.fireSearch({refreshButtonPressed:true})};return this.iSearchForValueWithActions(e)},iClearTheSearch:function(){return this.iSearchForValueWithActions([new i({text:""}),new t])},iSearchForSomethingWithNoResults:function(){return this.iSearchForValueWithActions([new i({text:u}),new t])}}),assertions:Object.assign({iShouldSeeTheTable:function(){return this.waitFor({id:h,viewName:o,success:function(t){e.assert.ok(t,"Found the object Table")},errorMessage:"Can't see the master Table."})},theTableShowsOnlyObjectsWithTheSearchStringInTheirTitle:function(){this.waitFor({id:[h,c],viewName:o,check:l,success:function(){e.assert.ok(true,"Every item did contain the title")},errorMessage:"The table did not have items"})},theTableHasEntries:function(){return this.waitFor({viewName:o,id:h,matchers:new r({name:"items"}),success:function(){e.assert.ok(true,"The table has entries")},errorMessage:"The table had no entries"})},theTableShouldHaveAllEntries:function(){var t;return this.waitFor({id:h,viewName:o,matchers:function(e){t=Math.min(e.getGrowingThreshold(),e._iVisibleItemsLength);return new n({name:"items",length:t}).isMatching(e)},success:function(i){e.assert.strictEqual(i.getItems().length,t,"The growing Table has "+t+" items")},errorMessage:"Table does not have all entries."})},theTitleShouldDisplayTheTotalAmountOfItems:function(){return this.waitFor({id:h,viewName:o,matchers:new r({name:"items"}),success:function(t){var i=t.getBinding("items").getLength();this.waitFor({id:"tableHeader",viewName:o,matchers:function(e){var t=e.getModel("i18n").getResourceBundle().getText("worklistTableTitleCount",[i]);return new s({name:"text",value:t}).isMatching(e)},success:function(){e.assert.ok(true,"The Page has a title containing the number "+i)},errorMessage:"The Page's header does not container the number of items "+i})},errorMessage:"The table has no items."})},theTableShouldContainOnlyFormattedUnitNumbers:function(){return this.theUnitNumbersShouldHaveTwoDecimals("sap.m.ObjectNumber",o,"Object numbers are properly formatted","Table has no entries which can be checked for their formatting")}})}})});